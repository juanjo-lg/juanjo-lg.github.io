<html lang="es" dir="ltr">
    <head>
        <meta charset="utf-8">
        <meta name="keywords" content="Modelo de muralla 3D">
        <meta name="author" content="Juanjo Lorenzo Gutiérrez">
        <link rel="stylesheet" href="styles/3d.css">
        <link href="https://fonts.googleapis.com/css2?family=Open+Sans&display=swap" rel="stylesheet">
        <title>Modelo 3D-3 - Muralla</title>
        <script>
          var ventana //Variable para abrir una ventana

          function inicio(){
            window.location.href = "https://juanjo-lg.github.io/general";
          }

          function imagen(URL) {
                window.open(URL, target="_blank");
          }

        </script>
    </head>
    <body>
        <model-viewer id="model" src="Zona_2.glb" poster="poster.png" camera-controls shadow-intensity="10" shadow-softness="1" exposure="1" camera-orbit="162.9deg 46.16deg 157.8m" min-camera-orbit="140deg 0deg auto" max-camera-orbit="180deg 90deg 157.8m" min-field-of-view="26.4deg" max-field-of-view="auto">
            <button onclick="imagen('https://juanjo-lg.github.io/puerta2')" class="Hotspot" slot="hotspot-1" data-position="75.35318500369794m 375.3664075574952m 10.650648254974293m" data-normal="-0.8655467017583225m 0.08565455144635313m -0.4934492931313344m" data-visibility-attribute="visible">
                <div class="HotspotAnnotation">Puerta</div>
            </button>
            <button onclick="imagen('https://juanjo-lg.github.io/muralla3')" class="Hotspot" slot="hotspot-2" data-position="57.207230941793426m 371.7601837728087m 20.79326703157978m" data-normal="0.6172682245032602m 0.09654604838641208m -0.7808065058383935m" data-visibility-attribute="visible">
                <div class="HotspotAnnotation">Muralla</div>
            </button>
            <button onclick="imagen('https://juanjo-lg.github.io/torre2')" class="Hotspot" slot="hotspot-3" data-position="35.67627544617066m 377.4386574807556m 3.4931968824446535m" data-normal="0.5292371132692918m -0.02137272730152356m -0.8482047420676694m" data-visibility-attribute="visible">
                <div class="HotspotAnnotation">Torre</div>
            </button>
            <button onclick="imagen('https://juanjo-lg.github.io/muralla4')" class="Hotspot" slot="hotspot-4" data-position="25.2033826554821m 370.17301279510406m 0.8683699393211777m" data-normal="0.6046939964315304m 0.09480165126078915m -0.790795686380428m" data-visibility-attribute="visible">
                <div class="HotspotAnnotation">Muralla</div>
            </button>
            <button onclick="imagen('https://juanjo-lg.github.io/torre3')" class="Hotspot" slot="hotspot-5" data-position="17.034325485888367m 377.1584816299421m -7.981304023239307m" data-normal="0.6198400065493602m 0.04868595210983963m -0.7832164734912357m" data-visibility-attribute="visible">
                <div class="HotspotAnnotation">Torre</div>
            </button>
            <button onclick="imagen('https://juanjo-lg.github.io/muralla5')" class="Hotspot" slot="hotspot-6" data-position="10.056227126722654m 371.2835125237066m -10.016177456228158m" data-normal="0.5581971908657392m 0.0028216364620382356m -0.8297035220349941m" data-visibility-attribute="visible">
                <div class="HotspotAnnotation">Muralla</div>
            </button>
            <button onclick="imagen('https://juanjo-lg.github.io/puerta3')" class="Hotspot" slot="hotspot-8" data-position="10.018706563891403m 375.9632606335681m -33.920270736370185m" data-normal="0.8831409481654846m 0.007245821365263814m 0.46905177085915767m" data-visibility-attribute="visible">
                <div class="HotspotAnnotation">Puerta</div>
            </button>
            <button onclick="imagen('https://juanjo-lg.github.io/muralla6')" class="Hotspot" slot="hotspot-9" data-position="-12.44091458642815m 372.31278439764395m -24.096487444159887m" data-normal="0.5193490495156169m -0.04463673353165404m -0.8533956449307962m" data-visibility-attribute="visible">
                <div class="HotspotAnnotation">Muralla</div>
            </button>
            <button onclick="imagen('https://juanjo-lg.github.io/muralla7')" class="Hotspot" slot="hotspot-10" data-position="-30.667932251061515m 372.1147060058169m -28.493517145810852m" data-normal="0.05906483279402265m -0.39396540888222054m -0.9172254914312398m" data-visibility-attribute="visible">
                <div class="HotspotAnnotation">Muralla</div>
            </button>

            <div id="controls" class="Annotation">
              <label for="src">Modelo:</label>
              <select id="src" class="" name="">
                <option value="Zona_2.glb">Talavera</option>
                <option value="Zona_1.glb">Muralla - El Salvador</option>
              </select><br>
  
              <label for="show-info">Info</label>
              <input id="show-info" type="checkbox" checked><br>
              <label for="show-area">Área</label>
              <input id="show-area" type="checkbox"><br>
              <label for="show-volume">Volumen</label>
              <input id="show-volume" type="checkbox"><br><br>
              <label onclick="inicio()" id="inicio">Inicio</label>
            </div>
        </model-viewer>
    </body>

    <!-- Loads model-viewer for modern browsers -->
    <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
    <!-- Loads model-viewer for older browsers -->
    <script nomodule src="https://unpkg.com/@google/model-viewer/dist/model-viewer-legacy.js"></script>

    <!-- Script para cambiar de un modelo a otro según la opción escogida. -->
    <script type="module">

      var informacion = [
        {
          nombre: 'Puerta',
          area: 'Area: 954 m2',
          volumen: 'Vol: 1235 m3'
        },
        {
          nombre: 'Muralla',
          area: 'Area: 975 m2',
          volumen: 'Vol: 1061 m3'
        },
        {
          nombre: 'Torre',
          area: 'Area: 296 m2',
          volumen: 'Vol: 300 m3'
        },
        {
          nombre: 'Muralla',
          area: 'Area: 473 m2',
          volumen: 'Vol: 483 m3'
        },
        {
          nombre: 'Torre',
          area: 'Area: 259 m2',
          volumen: 'Vol: 286 m3'
        },
        {
          nombre: 'Muralla',
          area: 'Area: 426 m2',
          volumen: 'Vol: 460 m3'
        },
        {
          nombre: 'Puerta',
          area: 'Area: 1193 m2',
          volumen: 'Vol: 1747 m3'
        },
        {
          nombre: 'Muralla',
          area: 'Area: 490 m2',
          volumen: 'Vol: 460 m3'
        },
        {
          nombre: 'Muralla',
          area: 'Area: 246 m2',
          volumen: 'Vol: 125 m3'
        }
      ];

      //Variable con el selector de ModelViewer.
      const modelViewer = document.querySelector('#model');

      //lista con los distintos <div> que muestran la información.
      let annotation = modelViewer.getElementsByClassName('HotspotAnnotation');

      modelViewer.querySelector('#src').addEventListener('input', (event) => {
        modelViewer.src = event.target.value;
        if (modelViewer.src == "Zona_1.glb") {
          window.location.href = "https://juanjo-lg.github.io/zona1";
        }
      });

      //selector con el checkbox de información.
      const checkinfo = modelViewer.querySelector('#show-info');

      //Evento para hacer aparecer y desaparecer las etiquetas.
      checkinfo.addEventListener('change', () => {
        modelViewer.querySelectorAll('button').forEach((hotspot) => {
          if (checkinfo.checked) {
            hotspot.classList.remove('hide');
          } else {
            hotspot.classList.add('hide');
            //desmarca las demás casillas de información.
            checkarea.checked = false;
            checkvolume.checked = false;
            for (var i = 0; i < annotation.length; i++) {
              //muestra los nombres y las áreas.
              annotation[i].innerHTML = informacion[i].nombre;
            }
          }
        });
      });

      //selector con el checkbox de área.
      const checkarea = modelViewer.querySelector('#show-area');

      //Evento para mostrar información de área.
      checkarea.addEventListener('change', () => {
          if (checkarea.checked && checkvolume.checked) {
            //bucle con los div.
            for (var i = 0; i < annotation.length; i++) {
              //muestra los nombres y las áreas.
              annotation[i].innerHTML = informacion[i].nombre + "<br>" + informacion[i].area + "<br>" + informacion[i].volumen;
            }
          } else if (checkarea.checked && !checkvolume.checked){
              for (var i = 0; i < annotation.length; i++) {
                //var texto = annotation[i].innerText;
                annotation[i].innerHTML = informacion[i].nombre + "<br>" + informacion[i].area;
              }
          } else if (!checkarea.checked && checkvolume.checked){
              for (var i = 0; i < annotation.length; i++) {
              //muestra los nombres y las áreas.
              annotation[i].innerHTML = informacion[i].nombre + "<br>" + informacion[i].volumen;
              }
          } else {
            for (var i = 0; i < annotation.length; i++) {
              annotation[i].innerHTML = informacion[i].nombre;
            }
          }
        });

      //selector con el checkbox de volúmenes.
      const checkvolume = modelViewer.querySelector('#show-volume');

      //Evento para mostrar la información de los volúmenes.
      checkvolume.addEventListener('change', () => {
        if (checkvolume.checked && checkarea.checked) {
          for (var i = 0; i < annotation.length; i++) {
            //muestra los nombres y las áreas.
            annotation[i].innerHTML = informacion[i].nombre + "<br>" + informacion[i].area + "<br>" + informacion[i].volumen;
          }
        } else if (checkvolume.checked && !checkarea.checked) {
          for (var i = 0; i < annotation.length; i++) {
            annotation[i].innerHTML = informacion[i].nombre + "<br>" + informacion[i].volumen;
          }
        } else if (checkarea.checked && !checkvolume.checked){
          for (var i = 0; i < annotation.length; i++) {
              annotation[i].innerHTML = informacion[i].nombre + "<br>" + informacion[i].area;
          }
        } else {
          for (var i = 0; i < annotation.length; i++) {
            annotation[i].innerHTML = informacion[i].nombre;
          }
        }
      });

    </script>

    <style>
    #controls {
       position: absolute;
       bottom: 16px;
       left: 16px;
       max-width: unset;
       transform: unset;
     }

    .Hotspot {
        background: #fff;
        border-radius: 32px;
        border: 0;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.25);
        box-sizing: border-box;
        cursor: pointer;
        height: 24px;
        padding: 8px;
        position: relative;
        transition: opacity 0.3s;
        width: 24px;
    }

    .Hotspot:not([data-visible]) {
        background: transparent;
        border: 4px solid #fff;
        box-shadow: none;
        height: 32px;
        pointer-events: none;
        width: 32px;
    }

    .Hotspot:focus {
        border: 4px solid rgb(0, 128, 200);
        height: 32px;
        outline: none;
        width: 32px;
    }

    .Hotspot>* {
        opacity: 1;
        transform: translateY(-50%);
    }

    .HotspotAnnotation, .Annotation {
        background: #fff;
        border-radius: 4px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.25);
        color: rgba(0, 0, 0, 0.8);
        display: block;
        font-family: Futura, Helvetica Neue, sans-serif;
        font-size: 18px;
        font-weight: 700;
        left: calc(100% + 1em);
        max-width: 128px;
        overflow-wrap: break-word;
        padding: 0.5em 1em;
        position: absolute;
        top: 50%;
        width: max-content;
    }

    .Hotspot:not([data-visible])>* {
        opacity: 0;
        pointer-events: none;
        transform: translateY(calc(-50% + 4px));
        transition: transform 0.3s, opacity 0.3s;
    }

    /*Esto hace que se puedan ocultar las etiquetas*/
    .hide {
      display: none;
    }
    </style>
</html>
